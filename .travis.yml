language: php
deploy:
  provider: heroku
  api_key:
    secure: ZX0/k2uSME7hv40oRYBqU9Dc3YcJ+iDZqe20MZpgeDzG6BW/yjqHJi2RjuLA530RsD2WcGur/XUto7JQe3UhL9S1xOgi8ODkoz9PF8tmImc1tNfLMomrlRSAXn3K42xkuolRrvykTQmxftMDjNfQEGrdOx01MbFxpZnLJTHZTafF8VmWgwkID43ZSADhQ7SGsNnGxDxBoYshP4NuOGv++yhwtxMG2EBzsWVR1+ukNbSQnDmnqSaIqRUL+rogm/t++h1cVm226nXHSzK2QOLJqw31vL5Wzm7q2e3jlPjoCoQkEKypA86imrLDBtxoSyje+9gdbMhwus1WAjvE7MiVhlA+op5sQTz4UaQqXYwzVf8XG90kuE+ADyypMsG5Qkx28CW8iqAwaqJvTCEzngT3+bLNlJN6QKhKJTJfnJb0GcGd26aCoZqsGZVUtEBl0PVlP3vk3uqpfJ1ESakbGMciifA9uj3RPpSGcYt11m/2mxtpXaRxGW+UVuDuHbOsxM6Sw4Np3IBZo5FI5XcU3lGoXbAEwI4z8OuM4r+JZLl2odeCSu+bc1w00NciUgzF20NrS2kTzGGPKMc4Blnbhzlavf4v6hs/GLW2ZDF7SS0CHuIikiPlcxj/cRiJ0WdimxOLM48EE9+E5OnRgdPn9VZdfWKy0Ka2bQNxaSHL6osIdkU=
  app: app-parentplanet-2016
  on:
    repo: ParentPlanetApplication/app-parentplanet-2016
    branch: heroku
  run:
    - "which seq"

# see http://about.travis-ci.org/docs/user/languages/php/ for more hints
language: php

# list any PHP version you want to test against
php:
  # using major version aliases

  # aliased to 5.2.17
  - 5.2
  # aliased to 5.3.29
  - 5.3
  # aliased to a recent 5.4.x version
  - 5.4
  # aliased to a recent 5.5.x version
  - 5.5
  # aliased to a recent 5.6.x version
  - 5.6
  # aliased to a recent 7.x version
  - 7.0
  # aliased to a recent hhvm version
  - hhvm

# optionally specify a list of environments, for example to test different RDBMS
env:
  - DB=mysql
  - DB=pgsql

# optionally set up exclutions and allowed failures in the matrix
matrix:
  exclude:
    - php: hhvm
      env: DB=pgsql  # PDO driver for pgsql is unsupported by HHVM (3rd party install for support)
  allow_failures:
    - php: 7.0
    - php: hhvm

# execute any number of scripts before the test run, custom env's are available as variables
before_script:
  - if [[ "$DB" == "pgsql" ]]; then psql -c "DROP DATABASE IF EXISTS hello_world_test;" -U postgres; fi
  - if [[ "$DB" == "pgsql" ]]; then psql -c "create database hello_world_test;" -U postgres; fi
  - if [[ "$DB" == "mysql" ]]; then mysql -e "create database IF NOT EXISTS hello_world_test;" -uroot; fi

# omitting "script:" will default to phpunit
# use the $DB env variable to determine the phpunit.xml to use
script: phpunit --configuration phpunit_$DB.xml --coverage-text
